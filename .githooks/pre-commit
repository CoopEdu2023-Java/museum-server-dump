#!/bin/sh

echo "Running Spotless..."
mvn spotless:apply

# Check if Spotless succeeded
if [ $? -ne 0 ]; then
  echo "Spotless formatting failed. Please fix the issues and try again."
  exit 1
fi

# Re-stage all modified files
echo "Re-staging modified files..."
git add -u

# Check if there are still staged changes
if ! git diff --cached --exit-code > NUL 2>&1; then
  echo "Files were formatted and re-staged."
  echo "Proceeding with the commit..."
else
  echo "No formatting changes detected."
fi

exit 0
